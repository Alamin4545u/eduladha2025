<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Gigapub Premium Auto-Earner</title>
    
    <!-- External Assets -->
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css">

    <!-- ðŸ”¥ GIGAPUB SCRIPT (ID: 4413) ðŸ”¥ -->
    <script src="https://ad.gigapub.tech/script?id=4413" onerror="app.scriptError()"></script>

    <style>
        :root {
            --bg-dark: #0f172a;
            --card-bg: rgba(30, 41, 59, 0.7);
            --glass-border: rgba(255, 255, 255, 0.08);
            --primary: #8b5cf6;
            --primary-glow: rgba(139, 92, 246, 0.5);
            --secondary: #3b82f6;
            --danger: #ef4444;
            --success: #22c55e;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --font-main: 'Outfit', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: var(--font-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            background-image: radial-gradient(circle at 50% 0%, #1e1b4b 0%, #0f172a 70%);
        }

        /* Utilities */
        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.5s ease-in; }

        /* Splash Screen */
        #splash-screen {
            position: fixed; inset: 0; z-index: 9999;
            background: var(--bg-dark);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            transition: opacity 0.5s ease;
        }
        .logo-pulse {
            font-size: 4rem; color: var(--primary);
            filter: drop-shadow(0 0 15px var(--primary-glow));
            animation: pulse 1.5s infinite;
            margin-bottom: 20px;
        }

        /* Auth Screen */
        #auth-screen {
            position: fixed; inset: 0; z-index: 900;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(10px);
            display: flex; align-items: center; justify-content: center; padding: 20px;
        }
        .login-card { text-align: center; width: 100%; max-width: 350px; }

        /* Inputs & Buttons */
        input {
            width: 100%; padding: 16px; margin: 20px 0;
            background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border);
            border-radius: 16px; color: white; font-size: 1rem; outline: none;
            text-align: center; transition: 0.3s;
        }
        input:focus { border-color: var(--primary); box-shadow: 0 0 10px var(--primary-glow); }

        .btn-primary {
            width: 100%; padding: 16px; border: none; border-radius: 16px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white; font-weight: 700; cursor: pointer; font-size: 1rem;
            box-shadow: 0 4px 20px var(--primary-glow); transition: transform 0.2s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-danger {
            width: 100%; padding: 16px; border: none; border-radius: 16px;
            background: linear-gradient(135deg, #ef4444, #b91c1c);
            color: white; font-weight: 700; cursor: pointer; font-size: 1rem;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        button:active { transform: scale(0.96); }

        /* Layout */
        #app-container { height: 100%; display: flex; flex-direction: column; }

        header {
            padding: 20px 25px;
            display: flex; justify-content: space-between; align-items: center;
            background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--glass-border);
        }
        .user-info h3 { font-size: 1.1rem; }
        .user-info span { font-size: 0.8rem; color: var(--text-muted); }
        .balance-badge {
            background: rgba(255, 215, 0, 0.1); color: #fbbf24;
            padding: 8px 15px; border-radius: 25px; border: 1px solid rgba(251, 191, 36, 0.3);
            font-weight: 700; display: flex; align-items: center; gap: 6px;
        }

        main { flex: 1; overflow-y: auto; padding: 25px; padding-bottom: 100px; }
        
        section { display: none; }
        section.active-view { display: block; animation: slideUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        /* Cards */
        .glass-card {
            background: var(--card-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 24px; padding: 25px; margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        /* Stats */
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .stat-box {
            background: rgba(255,255,255,0.03); border-radius: 18px; padding: 15px;
            display: flex; flex-direction: column; align-items: center; text-align: center;
        }
        .stat-box i { font-size: 1.5rem; margin-bottom: 5px; }
        .stat-box.blue i { color: #60a5fa; }
        .stat-box.purple i { color: #c084fc; }
        .stat-box h2 { font-size: 1.5rem; margin-top: 5px; }

        /* Engine Panel */
        .engine-status { 
            display: flex; align-items: center; gap: 10px; margin-bottom: 20px; 
            font-weight: 600; font-size: 0.9rem;
        }
        .dot { width: 10px; height: 10px; border-radius: 50%; background: #64748b; transition: 0.3s; }
        .dot.active { background: #22c55e; box-shadow: 0 0 10px #22c55e; }

        /* Circular Timer */
        .timer-wrapper { position: relative; width: 160px; height: 160px; margin: 0 auto 30px; }
        .timer-svg { width: 100%; height: 100%; transform: rotate(-90deg); }
        .circle-bg { fill: none; stroke: rgba(255,255,255,0.05); stroke-width: 10; }
        .circle-progress { 
            fill: none; stroke: var(--primary); stroke-width: 10; stroke-linecap: round;
            stroke-dasharray: 440; stroke-dashoffset: 440; transition: stroke-dashoffset 1s linear;
        }
        .timer-content { 
            position: absolute; inset: 0; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; 
        }
        .timer-content h1 { font-size: 3.5rem; line-height: 1; }
        .timer-content span { font-size: 0.9rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }

        /* Console Log */
        .console-log {
            width: 100%; height: 100px; background: rgba(0,0,0,0.5); border-radius: 12px;
            padding: 10px; font-family: 'Courier New', monospace; font-size: 0.75rem;
            overflow-y: auto; margin-top: 20px; border: 1px solid var(--glass-border);
        }
        .log-line { margin-bottom: 4px; display: block; }
        .log-success { color: #4ade80; }
        .log-error { color: #f87171; }
        .log-info { color: #94a3b8; }

        /* Navigation */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; right: 0; height: 80px;
            background: rgba(15, 23, 42, 0.95); backdrop-filter: blur(20px);
            border-top: 1px solid var(--glass-border);
            display: flex; justify-content: space-around; align-items: center;
            z-index: 100; padding-bottom: 10px;
        }
        .nav-btn { color: #64748b; font-size: 1.6rem; padding: 10px; position: relative; transition: 0.3s; }
        .nav-btn.active { color: var(--text-main); }
        .nav-btn.active::after {
            content: ''; position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%);
            width: 5px; height: 5px; background: var(--primary); border-radius: 50%;
        }
        .play-btn-wrapper { transform: translateY(-25px); }
        .play-btn {
            width: 65px; height: 65px; background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; color: white; box-shadow: 0 10px 25px var(--primary-glow);
            border: 5px solid var(--bg-dark); cursor: pointer;
        }

        /* Animations */
        @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.1); opacity: 0.8; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    </style>
</head>
<body>

    <!-- Splash Screen -->
    <div id="splash-screen">
        <div class="logo-pulse">
            <i class="ti ti-bolt"></i>
        </div>
        <h2>GigaEarn</h2>
        <p style="color: var(--text-muted); margin-top: 10px;">Checking Ad Network...</p>
    </div>

    <!-- Login Screen -->
    <div id="auth-screen" class="hidden">
        <div class="glass-card login-card fade-in">
            <div style="font-size: 3rem; color: var(--secondary); margin-bottom: 15px;"><i class="ti ti-user-circle"></i></div>
            <h1>Welcome Back</h1>
            <p style="color: var(--text-muted);">Enter your username to begin.</p>
            <input type="text" id="username-input" placeholder="e.g. JoyQuiz123" autocomplete="off">
            <button class="btn-primary" onclick="App.login()">
                Start Earning <i class="ti ti-arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app-container" class="hidden">
        
        <header>
            <div class="user-info">
                <span>Welcome,</span>
                <h3 id="display-username">User</h3>
            </div>
            <div class="balance-badge">
                <i class="ti ti-coin"></i> <span id="header-balance">0.00</span>
            </div>
        </header>

        <main>
            <!-- 1. HOME DASHBOARD -->
            <section id="view-home" class="active-view">
                <div class="stats-grid">
                    <div class="stat-box blue">
                        <i class="ti ti-eye"></i>
                        <span>Impressions</span>
                        <h2 id="total-impressions">0</h2>
                    </div>
                    <div class="stat-box purple">
                        <i class="ti ti-wallet"></i>
                        <span>Earnings</span>
                        <h2 id="total-earnings">$0.00</h2>
                    </div>
                </div>

                <div class="glass-card" style="margin-top: 20px;">
                    <h3>Account Status</h3>
                    <div style="margin-top: 15px; display: flex; justify-content: space-between; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 10px;">
                        <span style="color: var(--text-muted);">Network</span>
                        <span style="color: var(--success);">Gigapub Direct</span>
                    </div>
                    <div style="margin-top: 10px; display: flex; justify-content: space-between;">
                        <span style="color: var(--text-muted);">User ID</span>
                        <span id="user-uid" style="font-family: monospace;">---</span>
                    </div>
                </div>

                <button class="btn-primary" onclick="App.navTo('earn')">
                    <i class="ti ti-player-play"></i> Open Auto-Panel
                </button>
            </section>

            <!-- 2. EARNING PANEL -->
            <section id="view-earn">
                <div class="glass-card" style="text-align: center;">
                    <div class="engine-status">
                        <div id="status-dot" class="dot"></div>
                        <span id="engine-state-text">Engine Stopped</span>
                    </div>

                    <div class="timer-wrapper">
                        <svg class="timer-svg" viewBox="0 0 160 160">
                            <circle class="circle-bg" cx="80" cy="80" r="70"></circle>
                            <circle id="progress-ring" class="circle-progress" cx="80" cy="80" r="70"></circle>
                        </svg>
                        <div class="timer-content">
                            <h1 id="countdown-text">10</h1>
                            <span>Seconds</span>
                        </div>
                    </div>

                    <button id="btn-start" class="btn-primary" onclick="Engine.start()">
                        <i class="ti ti-bolt"></i> Start Auto-Impression
                    </button>
                    
                    <button id="btn-stop" class="btn-danger hidden" onclick="Engine.stop()">
                        <i class="ti ti-player-pause"></i> Stop Engine
                    </button>

                    <div class="console-log" id="log-container">
                        <span class="log-line log-info">> System Initialized...</span>
                    </div>
                </div>

                <!-- Hidden Ad Container (Required for Script) -->
                <div style="opacity: 0.5; text-align: center; margin-top: 20px; font-size: 0.8rem; color: #444;">
                    Gigapub ID: 4413 | Banner Slot
                </div>
            </section>

            <!-- 3. PROFILE -->
            <section id="view-profile">
                <div class="glass-card" style="text-align: center;">
                    <div style="width: 80px; height: 80px; background: rgba(255,255,255,0.1); border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 2.5rem;">
                        <i class="ti ti-user"></i>
                    </div>
                    <h2 id="profile-name">User</h2>
                    <p style="color: var(--text-muted);">Premium Publisher</p>
                    
                    <div style="margin-top: 30px;">
                        <button class="btn-danger" style="background: transparent; border: 1px solid var(--danger); color: var(--danger);" onclick="App.logout()">
                            <i class="ti ti-logout"></i> Logout
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Navigation -->
        <nav class="bottom-nav">
            <div class="nav-btn active" onclick="App.navTo('home', this)">
                <i class="ti ti-home"></i>
            </div>
            <div class="play-btn-wrapper" onclick="App.navTo('earn')">
                <div class="play-btn">
                    <i class="ti ti-bolt"></i>
                </div>
            </div>
            <div class="nav-btn" onclick="App.navTo('profile', this)">
                <i class="ti ti-user"></i>
            </div>
        </nav>
    </div>

    <!-- LOGIC -->
    <script>
        const CONFIG = {
            cycleTime: 10, // Seconds
            payout: 0.0005, // Per ad
            storageKey: 'giga_premium_v1'
        };

        // --- Data Manager ---
        const Data = {
            user: { name: null, earnings: 0, impressions: 0, uid: null },
            load() {
                const saved = localStorage.getItem(CONFIG.storageKey);
                if(saved) this.user = JSON.parse(saved);
                return !!saved;
            },
            save() {
                localStorage.setItem(CONFIG.storageKey, JSON.stringify(this.user));
                App.updateUI();
            },
            create(name) {
                this.user.name = name;
                this.user.uid = 'GP-' + Math.floor(Math.random() * 999999);
                this.save();
            }
        };

        // --- Engine Logic (Auto Impression) ---
        const Engine = {
            active: false,
            timer: null,
            timeLeft: CONFIG.cycleTime,
            
            start() {
                if(this.active) return;
                
                // Check if script exists
                if(typeof window.showGiga === 'undefined') {
                    App.log("âš ï¸ Gigapub script missing or blocked by AdBlocker.", "error");
                    alert("Please disable AdBlocker to earn rewards.");
                }

                this.active = true;
                document.getElementById('btn-start').classList.add('hidden');
                document.getElementById('btn-stop').classList.remove('hidden');
                document.getElementById('status-dot').classList.add('active');
                document.getElementById('engine-state-text').innerText = "Engine Running";
                document.getElementById('engine-state-text').style.color = "#22c55e";
                
                App.log("ðŸš€ Engine started. Auto-refreshing ads...", "success");
                this.loop();
            },

            stop() {
                this.active = false;
                clearInterval(this.timer);
                this.timeLeft = CONFIG.cycleTime;
                this.updateCircle(0);
                document.getElementById('countdown-text').innerText = CONFIG.cycleTime;
                
                document.getElementById('btn-start').classList.remove('hidden');
                document.getElementById('btn-stop').classList.add('hidden');
                document.getElementById('status-dot').classList.remove('active');
                document.getElementById('engine-state-text').innerText = "Engine Stopped";
                document.getElementById('engine-state-text').style.color = "#94a3b8";
                App.log("ðŸ›‘ Engine stopped by user.", "info");
            },

            loop() {
                this.timeLeft = CONFIG.cycleTime;
                
                this.timer = setInterval(() => {
                    if(!this.active) return;

                    this.timeLeft--;
                    const percent = ((CONFIG.cycleTime - this.timeLeft) / CONFIG.cycleTime) * 100;
                    this.updateCircle(percent);
                    document.getElementById('countdown-text').innerText = this.timeLeft;

                    if(this.timeLeft <= 0) {
                        this.triggerAd();
                        this.timeLeft = CONFIG.cycleTime; // Reset loop immediately
                    }
                }, 1000);
            },

            async triggerAd() {
                App.log("ðŸ”„ Requesting new ad...", "info");
                
                // Try to show ad
                try {
                    if (typeof window.showGiga === 'function') {
                        // Call the Gigapub function
                        window.showGiga().then(() => {
                            this.success();
                        }).catch((err) => {
                            // Even if it fails (no fill), we log it but keep engine running
                            App.log("âš ï¸ Ad not filled (Network busy). Retrying...", "error");
                        });
                    } else {
                        // Fallback/Demo mode if script isn't loaded (For Testing)
                        App.log("âš ï¸ Script not found. Simulating impression...", "error");
                        // Optional: Still give reward for testing UI
                        // this.success(); 
                    }
                } catch (e) {
                    console.error(e);
                }
            },

            success() {
                Data.user.impressions++;
                Data.user.earnings += CONFIG.payout;
                Data.save();
                App.log(`âœ… Ad Loaded! Earnings: $${Data.user.earnings.toFixed(4)}`, "success");
            },

            updateCircle(percent) {
                const circle = document.getElementById('progress-ring');
                const radius = circle.r.baseVal.value;
                const circumference = radius * 2 * Math.PI; // approx 440
                const offset = circumference - (percent / 100) * circumference;
                circle.style.strokeDashoffset = offset;
            }
        };

        // --- App Controller ---
        const App = {
            init() {
                // Remove Splash
                setTimeout(() => {
                    document.getElementById('splash-screen').style.opacity = 0;
                    setTimeout(() => {
                        document.getElementById('splash-screen').classList.add('hidden');
                        if(Data.load()) {
                            this.showDashboard();
                        } else {
                            document.getElementById('auth-screen').classList.remove('hidden');
                        }
                    }, 500);
                }, 2000);
            },

            login() {
                const input = document.getElementById('username-input');
                const name = input.value.trim();
                if(name.length > 2) {
                    Data.create(name);
                    document.getElementById('auth-screen').classList.add('hidden');
                    this.showDashboard();
                } else {
                    alert("Enter a valid username!");
                }
            },

            showDashboard() {
                document.getElementById('app-container').classList.remove('hidden');
                this.updateUI();
            },

            updateUI() {
                document.getElementById('display-username').innerText = Data.user.name;
                document.getElementById('profile-name').innerText = Data.user.name;
                document.getElementById('user-uid').innerText = Data.user.uid;
                
                document.getElementById('total-impressions').innerText = Data.user.impressions;
                document.getElementById('total-earnings').innerText = '$' + Data.user.earnings.toFixed(4);
                document.getElementById('header-balance').innerText = Data.user.earnings.toFixed(4);
            },

            navTo(viewId, btnElement) {
                // Switch View
                document.querySelectorAll('section').forEach(el => el.classList.remove('active-view'));
                document.getElementById('view-' + viewId).classList.add('active-view');

                // Switch Nav Active State
                document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
                if(btnElement) btnElement.classList.add('active');
            },

            log(msg, type) {
                const container = document.getElementById('log-container');
                const p = document.createElement('span');
                const time = new Date().toLocaleTimeString().split(' ')[0];
                p.className = `log-line log-${type}`;
                p.innerText = `[${time}] ${msg}`;
                container.prepend(p);
            },

            logout() {
                if(confirm("Logout? Your local data will be kept.")) {
                    location.reload();
                }
            },
            
            scriptError() {
                console.log("Gigapub script failed to load");
                // We handle this in Engine.start()
            }
        };

        // Start App
        window.onload = () => App.init();

    </script>
</body>
</html>
